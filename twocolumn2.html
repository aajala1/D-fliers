<!DOCTYPE HTML>
<html>
<head>
    <title>D-Fliers Dashboard</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <!-- Google Font: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Plotly -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.24.1/plotly.min.js"></script>
    
    <style>
        body, input, select, textarea {
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            background-color: #f9fbfd;
            text-transform: none !important;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            letter-spacing: -0.5px;
            color: #222;
            text-transform: none !important;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header {
            background: linear-gradient(90deg, #1e3c72 0%, #2a5298 100%);
            padding: 20px 0;
            color: white;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: white;
            margin: 0;
            font-size: 32px;
        }
        
        .nav {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .nav a {
            color: #007acc;
            text-decoration: none;
            margin: 0 20px;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .nav a:hover, .nav a.current {
            background-color: #007acc;
            color: white;
        }
        
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #007acc;
        }
        
        .button {
            background-color: #007acc;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
        }
        
        .button:hover {
            background-color: #005f99;
        }
        
        .button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .results-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: none;
        }
        
        .alert {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }
        
        .alert-success {
            background-color: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        
        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .alert-info {
            background-color: #e3f2fd;
            border-color: #2196f3;
            color: #0c5460;
        }
        
        .weather-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .weather-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #007acc;
        }
        
        .weather-card h4 {
            margin-top: 0;
            color: #007acc;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007acc;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .footer {
            text-align: center;
            padding: 20px 0;
            color: #666;
            border-top: 1px solid #e0e0e0;
            margin-top: 50px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            .weather-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>‚úàÔ∏è Flight Delay Predictor with Weather Analysis</h1>
        </div>
    </div>
    
    <div class="container">
        <nav class="nav">
            <a href="#" onclick="navigateTo('home')">Home</a>
            <a href="#" onclick="navigateTo('about')">About</a>
            <a href="#" onclick="navigateTo('dashboard')" class="current">Dashboard</a>
            <a href="#" onclick="navigateTo('contact')">Contact</a>
        </nav>
        
        <div class="form-container">
            <h2>üìã Flight Details</h2>
            <form id="flightForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="origin">üõ´ Origin Airport Code</label>
                        <input type="text" id="origin" maxlength="3" value="JFK" required>
                    </div>
                    <div class="form-group">
                        <label for="destination">üõ¨ Destination Airport Code</label>
                        <input type="text" id="destination" maxlength="3" value="LAX" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="airline">‚úàÔ∏è Airline</label>
                        <select id="airline" required>
                            <option value="AA">American Airlines (AA)</option>
                            <option value="UA">United Airlines (UA)</option>
                            <option value="DL">Delta Airlines (DL)</option>
                            <option value="WN">Southwest Airlines (WN)</option>
                            <option value="AS">Alaska Airlines (AS)</option>
                            <option value="B6">JetBlue Airways (B6)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="flightDate">üìÖ Flight Date</label>
                        <input type="date" id="flightDate" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="departureTime">‚è∞ Scheduled Departure</label>
                        <input type="time" id="departureTime" value="14:00" required>
                    </div>
                    <div class="form-group">
                        <label for="arrivalTime">‚è±Ô∏è Scheduled Arrival</label>
                        <input type="time" id="arrivalTime" value="17:00" required>
                    </div>
                </div>
                
                <button type="submit" class="button">üîÆ Predict Delay</button>
            </form>
        </div>
        
        <div id="loadingIndicator" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Analyzing flight data and weather conditions...</p>
        </div>
        
        <div id="resultsContainer" class="results-container">
            <h2>üìä Prediction Results</h2>
            <div id="predictionChart"></div>
            <div id="predictionSummary"></div>
            <div id="weatherAnalysis"></div>
        </div>
        
        <div class="footer">
            <p>&copy; 2025 D-Fliers - Powered by Machine Learning & Weather Analysis</p>
        </div>
    </div>

    <script>
        // Set default date to tomorrow
        document.getElementById('flightDate').valueAsDate = new Date(Date.now() + 24*60*60*1000);
        
        // Mock model data (in real implementation, this would come from your trained model)
        const mockModel = {
            // Simplified prediction logic based on common delay factors
            predict: function(inputs) {
                let baseDelay = 0;
                
                // Airport-specific factors
                const airportDelays = {
                    'JFK': 8, 'LGA': 12, 'EWR': 10, 'LAX': 6, 'ORD': 15,
                    'DFW': 5, 'ATL': 7, 'DEN': 9, 'SFO': 11, 'BOS': 8
                };
                
                baseDelay += (airportDelays[inputs.origin] || 5) + (airportDelays[inputs.destination] || 5);
                
                // Time-based factors
                const hour = parseInt(inputs.departureTime.split(':')[0]);
                if (hour >= 6 && hour <= 9) baseDelay += 10; // Morning rush
                if (hour >= 17 && hour <= 20) baseDelay += 8; // Evening rush
                if (hour >= 22 || hour <= 5) baseDelay += 15; // Late night/early morning
                
                // Airline factors
                const airlineDelays = {
                    'AA': 5, 'UA': 7, 'DL': 3, 'WN': 6, 'AS': 4, 'B6': 8
                };
                baseDelay += airlineDelays[inputs.airline] || 5;
                
                // Weather factors (simplified)
                if (inputs.weather) {
                    if (inputs.weather.precipitation > 5) baseDelay += 20;
                    if (inputs.weather.windSpeed > 40) baseDelay += 15;
                    if (inputs.weather.visibility < 5) baseDelay += 25;
                    if (inputs.weather.temperature < -5 || inputs.weather.temperature > 35) baseDelay += 10;
                }
                
                // Add some randomness
                baseDelay += Math.random() * 10 - 5;
                
                return Math.max(0, Math.round(baseDelay));
            }
        };
        
        // Mock weather data generator
        function generateMockWeather(airportCode, date) {
            const weather = {
                temperature: Math.random() * 30 + 5, // 5-35¬∞C
                humidity: Math.random() * 40 + 40, // 40-80%
                windSpeed: Math.random() * 50 + 5, // 5-55 km/h
                visibility: Math.random() * 8 + 2, // 2-10 km
                precipitation: Math.random() * 15, // 0-15 mm
                pressure: Math.random() * 50 + 990, // 990-1040 hPa
                conditions: ['Clear', 'Partly Cloudy', 'Cloudy', 'Light Rain', 'Heavy Rain', 'Thunderstorm', 'Fog'][Math.floor(Math.random() * 7)]
            };
            
            return weather;
        }
        
        // Weather analysis function
        function analyzeWeatherRisk(weather, location) {
            const risks = [];
            let riskLevel = 'LOW';
            
            if (weather.windSpeed > 40) {
                risks.push({
                    factor: 'High Wind Speed',
                    value: `${weather.windSpeed.toFixed(1)} km/h`,
                    severity: weather.windSpeed > 60 ? 'HIGH' : 'MEDIUM',
                    impact: 'Can cause landing/takeoff delays and turbulence'
                });
                riskLevel = weather.windSpeed > 60 ? 'HIGH' : 'MEDIUM';
            }
            
            if (weather.visibility < 5) {
                risks.push({
                    factor: 'Poor Visibility',
                    value: `${weather.visibility.toFixed(1)} km`,
                    severity: weather.visibility < 2 ? 'HIGH' : 'MEDIUM',
                    impact: 'Requires instrument approaches, reduces airport capacity'
                });
                if (weather.visibility < 2) riskLevel = 'HIGH';
                else if (riskLevel === 'LOW') riskLevel = 'MEDIUM';
            }
            
            if (weather.precipitation > 5) {
                risks.push({
                    factor: 'Heavy Precipitation',
                    value: `${weather.precipitation.toFixed(1)} mm`,
                    severity: weather.precipitation > 15 ? 'HIGH' : 'MEDIUM',
                    impact: 'Reduces runway capacity, increases stopping distances'
                });
                if (weather.precipitation > 15) riskLevel = 'HIGH';
                else if (riskLevel === 'LOW') riskLevel = 'MEDIUM';
            }
            
            if (weather.temperature < -5 || weather.temperature > 35) {
                risks.push({
                    factor: weather.temperature < -5 ? 'Extreme Cold' : 'Extreme Heat',
                    value: `${weather.temperature.toFixed(1)}¬∞C`,
                    severity: 'MEDIUM',
                    impact: weather.temperature < -5 ? 'Requires de-icing procedures' : 'Reduces aircraft performance'
                });
                if (riskLevel === 'LOW') riskLevel = 'MEDIUM';
            }
            
            return { risks, riskLevel };
        }
        
        // Create delay visualization
        function createDelayVisualization(prediction, airline, route) {
            const data = [{
                type: "indicator",
                mode: "gauge+number+delta",
                value: prediction,
                domain: { x: [0, 1], y: [0, 1] },
                title: { text: `${airline} ${route}<br>Delay Prediction (minutes)` },
                delta: { reference: 0 },
                gauge: {
                    axis: { range: [null, 120] },
                    bar: { color: "darkblue" },
                    steps: [
                        { range: [0, 15], color: "lightgreen" },
                        { range: [15, 30], color: "yellow" },
                        { range: [30, 60], color: "orange" },
                        { range: [60, 120], color: "red" }
                    ],
                    threshold: {
                        line: { color: "red", width: 4 },
                        thickness: 0.75,
                        value: 30
                    }
                }
            }];
            
            const layout = {
                height: 400,
                font: { color: "darkblue", family: "Inter" },
                margin: { t: 50, r: 50, l: 50, b: 50 }
            };
            
            Plotly.newPlot('predictionChart', data, layout);
        }
        
        // Handle form submission
        document.getElementById('flightForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const inputs = {
                origin: formData.get('origin').toUpperCase(),
                destination: formData.get('destination').toUpperCase(),
                airline: formData.get('airline'),
                flightDate: formData.get('flightDate'),
                departureTime: formData.get('departureTime'),
                arrivalTime: formData.get('arrivalTime')
            };
            
            // Validation
            if (inputs.origin === inputs.destination) {
                alert('Origin and destination cannot be the same!');
                return;
            }
            
            if (inputs.origin.length !== 3 || inputs.destination.length !== 3) {
                alert('Airport codes must be exactly 3 letters!');
                return;
            }
            
            // Show loading
            document.getElementById('loadingIndicator').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';
            
            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Generate mock weather data
            const originWeather = generateMockWeather(inputs.origin, inputs.flightDate);
            const destWeather = generateMockWeather(inputs.destination, inputs.flightDate);
            
            // Make prediction
            inputs.weather = originWeather; // Use origin weather for prediction
            const prediction = mockModel.predict(inputs);
            
            // Analyze weather risks
            const originAnalysis = analyzeWeatherRisk(originWeather, inputs.origin);
            const destAnalysis = analyzeWeatherRisk(destWeather, inputs.destination);
            
            // Hide loading and show results
            document.getElementById('loadingIndicator').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';
            
            // Create visualization
            createDelayVisualization(prediction, inputs.airline, `${inputs.origin} ‚Üí ${inputs.destination}`);
            
            // Display prediction summary
            let alertClass = 'alert-success';
            let severity = '‚úÖ On-Time or Early Arrival';
            let message = `Flight ${inputs.airline} ${inputs.origin} ‚Üí ${inputs.destination} is predicted to arrive on time or early.`;
            
            if (prediction > 0) {
                if (prediction > 30) {
                    alertClass = 'alert-danger';
                    severity = 'üî¥ Major Delay';
                } else if (prediction > 15) {
                    alertClass = 'alert-warning';
                    severity = 'üü° Significant Delay';
                } else {
                    alertClass = 'alert-warning';
                    severity = 'üü† Minor Delay';
                }
                message = `Flight ${inputs.airline} ${inputs.origin} ‚Üí ${inputs.destination} is predicted to arrive <strong>${prediction} minutes late</strong>.`;
            }
            
            document.getElementById('predictionSummary').innerHTML = `
                <div class="alert ${alertClass}">
                    <h4>${severity}</h4>
                    <p>${message}</p>
                </div>
            `;
            
            // Display weather analysis
            const overallRisk = (originAnalysis.riskLevel === 'HIGH' || destAnalysis.riskLevel === 'HIGH') ? 'HIGH' : 
                              (originAnalysis.riskLevel === 'MEDIUM' || destAnalysis.riskLevel === 'MEDIUM') ? 'MEDIUM' : 'LOW';
            
            const riskColors = { HIGH: '#f44336', MEDIUM: '#ff9800', LOW: '#4caf50' };
            const riskIcons = { HIGH: 'üî¥', MEDIUM: 'üü°', LOW: 'üü¢' };
            
            let weatherHTML = `
                <h3>üå§Ô∏è Weather Analysis</h3>
                <div class="alert" style="border-color: ${riskColors[overallRisk]}; background-color: ${riskColors[overallRisk]}20;">
                    <h4>${riskIcons[overallRisk]} Overall Weather Risk: ${overallRisk}</h4>
                    <p>Based on analysis of weather conditions at both origin and destination</p>
                </div>
                <div class="weather-grid">
                    <div class="weather-card">
                        <h4>üõ´ ${inputs.origin} Weather</h4>
                        <p><strong>Conditions:</strong> ${originWeather.conditions}</p>
                        <p><strong>Temperature:</strong> ${originWeather.temperature.toFixed(1)}¬∞C</p>
                        <p><strong>Wind Speed:</strong> ${originWeather.windSpeed.toFixed(1)} km/h</p>
                        <p><strong>Visibility:</strong> ${originWeather.visibility.toFixed(1)} km</p>
                        <p><strong>Precipitation:</strong> ${originWeather.precipitation.toFixed(1)} mm</p>
                        ${originAnalysis.risks.length > 0 ? 
                            '<h5>Risk Factors:</h5>' + 
                            originAnalysis.risks.map(risk => 
                                `<div style="margin: 5px 0; padding: 8px; background: #f8f9fa; border-radius: 4px;">
                                    <strong>${risk.factor}:</strong> ${risk.value}<br>
                                    <em>${risk.impact}</em>
                                </div>`
                            ).join('') : 
                            '<p style="color: #28a745;">‚úÖ No significant weather issues detected</p>'
                        }
                    </div>
                    <div class="weather-card">
                        <h4>üõ¨ ${inputs.destination} Weather</h4>
                        <p><strong>Conditions:</strong> ${destWeather.conditions}</p>
                        <p><strong>Temperature:</strong> ${destWeather.temperature.toFixed(1)}¬∞C</p>
                        <p><strong>Wind Speed:</strong> ${destWeather.windSpeed.toFixed(1)} km/h</p>
                        <p><strong>Visibility:</strong> ${destWeather.visibility.toFixed(1)} km</p>
                        <p><strong>Precipitation:</strong> ${destWeather.precipitation.toFixed(1)} mm</p>
                        ${destAnalysis.risks.length > 0 ? 
                            '<h5>Risk Factors:</h5>' + 
                            destAnalysis.risks.map(risk => 
                                `<div style="margin: 5px 0; padding: 8px; background: #f8f9fa; border-radius: 4px;">
                                    <strong>${risk.factor}:</strong> ${risk.value}<br>
                                    <em>${risk.impact}</em>
                                </div>`
                            ).join('') : 
                            '<p style="color: #28a745;">‚úÖ No significant weather issues detected</p>'
                        }
                    </div>
                </div>
            `;
            
            document.getElementById('weatherAnalysis').innerHTML = weatherHTML;
        });
        
        // Navigation function (placeholder)
        function navigateTo(page) {
            alert(`Navigation to ${page} page - This would be implemented with your routing system`);
        }
    </script>
</body>
</html>
